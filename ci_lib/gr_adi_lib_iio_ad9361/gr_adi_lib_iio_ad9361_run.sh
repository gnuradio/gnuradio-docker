#!/usr/bin/env bash

# Copyright (c) 2020 - 2021 Adam Horden <adam.horden@horden.engineering>

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

set \
  -o \
    "errexit" \
  -o \
    "xtrace" \

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

export DOCKER_BUILDKIT="$(\
  printf \
    "%d" \
    "1" \
)"

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

docker \
  image \
      tag \
      "gr_adi_lib_iio:v0.21" \
      "gnuradio/gr_adi_lib_iio:v0.21"

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

docker \
  build \
  --build-arg \
    GR_BLD_ARCH="${GR_BLD_ARCH}" \
  --build-arg \
    GR_ADI_LIB_IIO_AD9361_SRC="https://github.com/analogdevicesinc/libad9361-iio.git" \
  --build-arg \
    GR_ADI_LIB_IIO_AD9361_SRC_TAG="v0.2" \
  --build-arg \
    GR_ADI_LIB_IIO_AD9361_SRC_VER="v_0_2" \
  --file \
    "gr_adi_lib_iio_ad9361" \
  --progress \
    "plain" \
  --tag \
    "gr_adi_lib_iio_ad9361:v0.2" \
  "$(pwd)"

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

# docker \
#   image \
#     tag \
#       "gr_adi_lib_iio_ad9361:v0.2" \
#       "gnuradio/gr_adi_lib_iio_ad9361:v0.2"

# ----------------------------------------------------------------------------------------
#
# ----------------------------------------------------------------------------------------

# docker \
#   push \
#     "gnuradio/gr_adi_lib_iio_ad9361:v0.2"
